<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<style>
html {
  scroll-behavior: smooth;
}
	*{
  box-sizing: border-box;
}
body{
  margin:0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-size:1rem;
  font-weight:normal;
  line-height:1.5;
  color:#333;
  overflow-x:hidden;
  padding-top:100px;
}
.v-header{
  height:100vh;
  display:flex;
  align-items:center;
  color:#fff;
}
.container{
  max-width:960px;
  padding-left:1rem;
  padding-right:1rem;
  margin:auto;
  text-align:center;
}
.fullscreen-video-wrap{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100vh;
}
.fullscreen-video-wrap video{
  min-height:100%;
  min-width:100%;
}
.header-content{
  z-index:2;
  margin-left: auto;
  margin-right: auto;
}
.header-content h1{
  font-size:50px;
  margin-bottom:0;
}
.header-content p{
  font-size:1.5rem;
  display:block;
  padding-bottom:2rem;
}
.btn-vid{
  font-size:1.2rem;
  padding: 1rem 2rem;
  text-decoration: none;
}
.section{
  padding:20px;
  padding-top:325px;
  padding-bottom:300px;
}
@media(max-width:960px){
  .container{
    padding-right:3rem;
    padding-left:3rem;
  }
}
}
.dropdown-check-list {
  display: inline-block;
}
.dropdown-check-list .anchor {
  position: relative;
  cursor: pointer;
  display: inline-block;
  padding: 5px 50px 5px 10px;
  border: 1px solid #ccc;
}
.dropdown-check-list .anchor:after {
  position: absolute;
  content: "";
  border-left: 2px solid black;
  border-top: 2px solid black;
  padding: 5px;
  right: 10px;
  top: 20%;
  -moz-transform: rotate(-135deg);
  -ms-transform: rotate(-135deg);
  -o-transform: rotate(-135deg);
  -webkit-transform: rotate(-135deg);
  transform: rotate(-135deg);
}
.dropdown-check-list .anchor:active:after {
  right: 8px;
  top: 21%;
}
.dropdown-check-list ul.items {
  padding: 2px;
  display: none;
  margin: 0;
  border: 1px solid #ccc;
  border-top: none;
}
.dropdown-check-list ul.items li {
  list-style: none;
}
</style>
</head>

<body>
  <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ModalLabel"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- <div  id="recipeIngredients"></div> -->
                <div  id="recipeSteps"></div>
                <div  id="recipeTime"></div>
                <div  id="dietaryRestrictions">
                    <p id="vegitarian"></p>
                    <p id="gluten"></p>
                    <p id="vegan"></p>
                </div>
                <ul id="ingredientsList"></ul>
                
                <!-- <div id="otherThings"></div> -->
                
                <!-- <input type="text" id="candidate"/> -->
            </div>
            <div class="modal-footer">
                <p id="zaiddemodisplay"></p>
            </div>
            </div>
        </div>
        </div>
	<nav class="navbar navbar-expand-sm bg-light navbar-light fixed-top">
		<a class="navbar-brand" href="home.html">
			<img src="chef.jpg" alt="placeholder logo" width="30" height="30">
			CollegeChef™
		</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarSupportedContent">
			<ul class="navbar-nav mr-auto">
				<li class="nav-item active">
					<a class="nav-link" href="home.html">Home <span class="sr-only">(current)</span></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#">Recipes</a>
				</li>
			</ul>
			<div class="dropdown">
				<a class="nav-link dropdown-toggle" href="#" id="profileDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					<img src="push.gif" class="rounded-circle" alt="placeholder profile pic" width="40" height="40">
				</a>
				<div class="dropdown-menu" role="menu" aria-labelledby="profileDropdown">
					<div id="login_div">
						<li class="text-center">Sign in</li>
						<li>
							<div class="form-group">
								<input type="text" class="form-control" placeholder="Email" id="inputEmail">
							</div>
						</li>
						<li>
							<div class="form-group">
								<input type="password" class="form-control" placeholder="Password" id="inputPassword">
							</div>
						</li>
						<li class="text-center">
							<button class="btn btn-primary" onclick="login()">Submit</button> 
						</li>
						<div class="dropdown-divider"></div>
							<li class="text-center">
								<a href="register.html" class="btn btn-info" role="button">Sign Up</a>
							</li>
					</div>
					<div id="user_div">
						<li class="text-center" id="user_para">Hello User!</p>
						<li class="text-center">
							<button class="btn btn-danger" onclick="logout()">Log Out</button>
						</li>
					</div>
				</div>
			</div>	
			<a href="#">
				<span class="far fa-heart fa-lg" style="color:red" size="5x"></span>
			</a>
			
			<form class="form-inline my-2 my-lg-0">
				<input class="form-control mr-sm-2" type="search" placeholder="&#128269Search" aria-label="Search">
				<button class="btn btn-primary btn-sm" type="submit">Search</button>
			</form>
		</div>
	</nav>
	<header class="v-header container">
    <div class="fullscreen-video-wrap">
      <video src="collegechef.mp4" autoplay="" loop="" muted>
    </video>
    </div>
    <div class="header-overlay"></div>
    <div class="header-content text-md-center">
      <h1 id="home_head">Welcome to CollegeChef™</h1>
      <p id="home_para">Here at CollegeChef™, we hope to provide you with the best recipes that fit your lifestyle. Click the button below to sign up and start cooking.</p>
      <a id="home_btn" href="register.html" class="btn btn-dark btn-lg">Register Here</a>
    </div>
  </header>
  <section class="section section-a" id="section-a">
    <div class="container" style=" rounded; background-color:white;">
      <h2>Select Your Ingredients</h2>
	  <br>
      <div class="container">
		<table class="table">
		  <thead>
			<tr>
			  <th scope="col" >Fruits</th>
			  <th scope="col">Vegetables</th>
			  <th scope="col">Grains</th>
			  <th scope="col">Meat</th>
			  <th scope="col">Dairy</th>
			  <th scope="col">Other</th>
			</tr>
		  </thead>
		  <tbody>
			<tr>
			  <td>
				<div id="list1" class="dropdown-check-list" onclick="displaylist('list1', 'fruits')" tabindex="100">
					<span class="anchor">Select Fruits</span>
					<ul id="fruits" class="items">
						<li><input name = "ingredients" value = "apple" type="checkbox" />Apple </li>
						<li><input name = "ingredients" value = "orange" type="checkbox" />Orange</li>
						<li><input name = "ingredients" value = "grapes" type="checkbox" />Grapes </li>
						<li><input name = "ingredients" value = "berry" type="checkbox" />Berry </li>
						<li><input name = "ingredients" value = "mango" type="checkbox" />Mango </li>
						<li><input name = "ingredients" value = "banana" type="checkbox" />Banana </li>
						<li><input name = "ingredients" value = "tomato" type="checkbox" />Tomato</li>
					</ul>
				</div>
			  </td>
			  <td>
				<div id="list2" class="dropdown-check-list" onclick="displaylist('list2', 'veggies')" tabindex="100">
					<span class="anchor">Select Vegetables</span>
					<ul id="veggies" class="items">
						<li><input name = "ingredients" value = "broccoli" type="checkbox" />Broccoli </li>
						<li><input name = "ingredients" value = "cabbage" type="checkbox" />Cabbage</li>
						<li><input name = "ingredients" value = "carrots" type="checkbox" />Carrots </li>
						<li><input name = "ingredients" value = "asparagus" type="checkbox" />Asparagus </li>
						<li><input name = "ingredients" value = "cucumber" type="checkbox" />Cucumber </li>
						<li><input name = "ingredients" value = "radish" type="checkbox" />Radish </li>
						<li><input name = "ingredients" value = "potatoes" type="checkbox" />Potatoes</li>
					</ul>
				</div>
				
			  </td>
			  
			  <td>
				<div id="list3" class="dropdown-check-list" onclick="displaylist('list3', 'grains')" tabindex="100">
					<span class="anchor">Select Grains</span>
					<ul id="grains" class="items">
						<li><input name = "ingredients" value = "rice" type="checkbox" />Rice </li>
						<li><input name = "ingredients" value = "bread" type="checkbox" />Bread</li>
						<li><input name = "ingredients" value = "corn" type="checkbox" />Corn </li>
						<li><input name = "ingredients" value = "soy" type="checkbox" />Soy Beans </li>
						<li><input name = "ingredients" value = "tofu" type="checkbox" />Tofu </li>
						<li><input name = "ingredients" value = "sesame" type="checkbox" />Sesame</li>
					</ul>
				</div>
				
			  </td>
			  <td>
				<div id="list4" class="dropdown-check-list" onclick="displaylist('list4', 'meats')" tabindex="100">
					<span class="anchor">Select Meats</span>
					<ul id="meats" class="items">
						<li><input name = "ingredients" value = "chicken" type="checkbox" />Chicken</li>
						<li><input name = "ingredients" value = "beef" type="checkbox" />Beef</li>
						<li><input name = "ingredients" value = "turkey" type="checkbox" />Turkey </li>
						<li><input name = "ingredients" value = "pork" type="checkbox" />Pork</li>
						<li><input name = "ingredients" value = "ham" type="checkbox" />Ham</li>
						<li><input name = "ingredients" value = "duck" type="checkbox" />Duck</li>
						<li><input name = "ingredients" value = "lamb" type="checkbox" />Lamb</li>
					</ul>
				</div>
		
			  </td>
			  <td>
				<div id="list5" class="dropdown-check-list" onclick="displaylist('list5', 'dairy')" tabindex="100">
					<span class="anchor">Select Dairy</span>
					<ul id="dairy" class="items">
						<li><input name = "ingredients" value = "milk" type="checkbox" />Milk</li>
						<li><input name = "ingredients" value = "yogurt" type="checkbox" />Yogurt</li>
						<li><input name = "ingredients" value = "butter" type="checkbox" />Butter </li>
						<li><input name = "ingredients" value = "cheddar cheese" type="checkbox" />Cheddar Cheese</li>
						<li><input name = "ingredients" value = "pepper jack" type="checkbox" />Pepper Jack Cheese</li>
						<li><input name = "ingredients" value = "sour cream" type="checkbox" />Sour Cream</li>
						<li><input name = "ingredients" value = "ice cream" type="checkbox" />Ice Cream</li>
					</ul>
				</div>
				
			  </td>
			  <td>
				<div id="list6" class="dropdown-check-list" onclick="displaylist('list6', 'other')" tabindex="100">
					<span class="anchor" >Select Other</span>
					<ul id="other" class="items">
						<li><input name = "ingredients" value = "eggs" type="checkbox" />Eggs</li>
						<li><input name = "ingredients" value = "olive oil" type="checkbox" />Olive Oil</li>
						<li><input name = "ingredients" value = "salt" type="checkbox" />Salt </li>
						<li><input name = "ingredients" value = "pepper" type="checkbox" />Pepper</li>
						<li><input name = "ingredients" value = "dried bread crumbs" type="checkbox" />Dried Bread Crumbs</li>
						<li><input name = "ingredients" value = "ketchup" type="checkbox" />Ketchup</li>
						<li><input name = "ingredients" value = "Mayonnaise" type="checkbox" />Mayonnaise</li>
					</ul>
				</div>
				
			  </td>
			  <td>
				<div class="dropdown">
				  <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
					Filter
				  </button>
				  <div class="dropdown-menu">
					<a class="dropdown-item" href="#">Filter 1</a>
					<a class="dropdown-item" href="#">Filter 2</a>
					<a class="dropdown-item" href="#">Filter 3</a>
				  </div>
			  </div>
			  </td>
			</tr>
		  </tbody>
		</table>
		<br>
		
		<div class="text-center">
			<a href="#" class="btn btn-primary" onclick = "loadDoc()"role="button">Search Recipes</a>
		</div>
		<br>
	</div>
    </div>
  </section>
  <section class="section section-a" id="section-b">>
  	<div class = "container">
  		<div class = "row" id = "recipes-location">
  			
  		</div>
  	</div>
  </section>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="home.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.9.2/firebase.js"></script>
  <script>
		  // Initialize Firebase
		  var config = {
			apiKey: "AIzaSyBprXkeXD1HCJQZL4KtgmMaA3svUU7vcgI",
			authDomain: "collegechef-1789f.firebaseapp.com",
			databaseURL: "https://collegechef-1789f.firebaseio.com",
			projectId: "collegechef-1789f",
			storageBucket: "collegechef-1789f.appspot.com",
			messagingSenderId: "231942064234"
			};
		firebase.initializeApp(config);
  </script>
	
  <script src="accounts.js"></script>
  <script>
    function restrictions(temp)
    {
        document.getElementById('vegitarian').innerHTML = "";
        document.getElementById('vegan').innerHTML = "";
        document.getElementById('gluten').innerHTML = "";
        if(temp.vegetarian == true)
        {
            document.getElementById('vegitarian').innerHTML += '<p> Vegitarian: Yes</p>';
    
        }
        else if(temp.vegetarian == false)
        {
            document.getElementById('vegitarian').innerHTML += '<p> Vegitarian: No</p>';
        }
        if(temp.vegan == true)
        {
            document.getElementById('vegan').innerHTML += '<p> Vegan: Yes</p>';
        }
        else if(temp.vegan == false)
        {
            document.getElementById('vegan').innerHTML += '<p> Vegan: No</p>';
        }
        if(temp.glutenFree == true)
        {
            document.getElementById('gluten').innerHTML += '<p> Gluten Free: Yes</p>';
        }
        else if(temp.glutenFree == false)
        {
            document.getElementById('gluten').innerHTML += '<p> Gluten Free: No</p>';
        }
    }
    
    function recipeList(element)
    {
        var list = document.getElementById("ingredientsList");
        list.innerHTML = "";
        // console.log("HERERERE1"); 
        for(var i = 0; i < element.extendedIngredients.length; i++)
            {
                list.innerHTML += '<li>'+ element.extendedIngredients[i].name +'</li>'
                // console.log("HERERERE");    
                // console.log("INGREDIENTS: ", element.extendedIngredients[i].name, ", i: ", i);
            }
    }
    function displayMoreInfo(element) 
    {
        var xhttp = new XMLHttpRequest();
        //console.log('function called')
        //console.log(element.id);
        var id= element.id;
        url = "https://spoonacular-recipe-food-nutrition-v1.p.rapidapi.com/recipes/"+ id+ "/information"
        // console.log(`url is: ${url}`);
        // Next encode your ing_url using : encodeURI
        //ing_url = encodeURI(ing_url)
        // console.log(url);
        // do the http call.
        xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            //console.log(this.response)
            var json = JSON.parse(this.response);            
            //console.log(json);
            // document.getElementById('zaiddemodisplay').innerHTML = json.vegetarian;
            document.getElementById('ModalLabel').innerHTML = json.title;
            document.getElementById('recipeSteps').innerHTML = '<p>'+ json.instructions +'</p>';
            document.getElementById('recipeTime').innerHTML = '<p>Meal Ready In: '+ json.readyInMinutes +' minutes.</p>';
            restrictions(json);
            recipeList(json);
                        
        }
        else {
            console.log("Something went wrong")
        }
        }
        xhttp.open("GET", url,true);//, true);
        xhttp.setRequestHeader("X-RapidAPI-Key", "601fdf014cmsh9774814f1ee4e3dp10ecadjsn1de8cb4425cc");
        xhttp.send();
    }
    function loadDoc() 
    {
        var xhttp = new XMLHttpRequest();

        var all_ingredients = document.getElementsByName('ingredients');
        var ingredients = "";
        for(var i = 0; i <all_ingredients.length; i++)
        {
          if(all_ingredients[i].type == 'checkbox' && all_ingredients[i].checked == true)
          {
            ingredients += all_ingredients[i].value + '%2C'
          }
        }

        //document.getElementById('ingredients');  // assume it returns this array ['sugar, 'spice', 'everything nice']
      //  ing_url = "";
        //ingredients.forEach(function(item)
        //{
        //ing_url += item + "%2C"
        //})
        ingredients = ingredients.slice(0,-3);
        console.log(ingredients);
        // There will be a , in the end make sure you remove it
        base_url = "https://spoonacular-recipe-food-nutrition-v1.p.rapidapi.com/recipes/findByIngredients?number=5&ranking=2&ignorePantry=false&ingredients=";
        url = base_url + ingredients;
        console.log(`url is : ${url}`);
        xhttp.onreadystatechange = function() 
        {
            if (this.readyState == 4 && this.status == 200) 
            {
            	var card = "";
                response = JSON.parse(this.response);
                for(var i = 0; i < response.length; i++)
                {
                    //var card =  "";
                    card += '<div class="card" style="width: 18rem;"><img class="card-img-top" src=' ;
                    card +=  response[i]['image'];
                    card +=  '><div class="card-body"><h5 class="card-title">'; 
                    card +=  response[i]['title']; 
                    card +=  '</h5><p class="card-text">Used Ingredient Count: ';
                    card +=  response[i]['usedIngredientCount'];
                    card +=  '<br> Missed Ingredient Count: ';
                    card +=  response[i]['missedIngredientCount'];
                    card +=  '</p><btn id='+ response[i].id;
                    card +=  ' href="#" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" onclick="displayMoreInfo(this)">See More Information</btn</div></div>';  
                   
                    
                }
             	document.getElementById("recipes-location").innerHTML = card;   
             	console.log(card);
            }
        };
        
        xhttp.open("GET", url, true);
        xhttp.setRequestHeader("X-RapidAPI-Key", "601fdf014cmsh9774814f1ee4e3dp10ecadjsn1de8cb4425cc");
        xhttp.send();
    };
  </script>
</body>

</html>